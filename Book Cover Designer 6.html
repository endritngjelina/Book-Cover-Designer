<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Book Cover Designer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
            height: calc(100vh - 40px);
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .main-area {
            display: grid;
            grid-template-rows: 60px 1fr;
            gap: 20px;
        }

        .toolbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .canvas-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .book-cover {
            width: 400px;
            height: 600px;
            position: relative;
            background: linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%);
            border-radius: 8px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transform: perspective(1000px) rotateY(-5deg);
            transition: all 0.3s ease;
        }

        .book-cover:hover {
            transform: perspective(1000px) rotateY(0deg);
        }

        .cover-content {
            height: 100%;
            padding: 40px 30px;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 2;
        }

        .title {
            font-size: 48px;
            font-weight: bold;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 24px;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .author {
            font-size: 28px;
            color: white;
            text-align: center;
            margin-top: auto;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            height: 80px;
        }

        .color-input {
            height: 45px !important;
            cursor: pointer;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .preset-btn {
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .preset-btn:hover,
        .preset-btn.active {
            border-color: #667eea;
            background: #f8f9ff;
            color: #667eea;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e1e5e9;
        }

        .toolbar-left {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .toolbar-right {
            display: flex;
            gap: 15px;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zoom-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 6px;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .zoom-btn:hover {
            background: #e9ecef;
        }

        .gradient-picker {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .gradient-option {
            width: 100%;
            height: 40px;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gradient-option:hover,
        .gradient-option.active {
            border-color: #667eea;
            transform: scale(1.05);
        }

        .font-preview {
            margin-top: 8px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            text-align: center;
            font-size: 18px;
        }

        .effects-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .effect-btn {
            padding: 8px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 11px;
            transition: all 0.3s ease;
        }

        .effect-btn:hover,
        .effect-btn.active {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .dimension-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .downloading {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h2 class="section-title">📚 Book Details</h2>
            
            <div class="form-group">
                <label for="bookTitle">Book Title</label>
                <input type="text" id="bookTitle" placeholder="Enter your book title" value="The Great Adventure">
            </div>
            
            <div class="form-group">
                <label for="bookSubtitle">Subtitle (Optional)</label>
                <input type="text" id="bookSubtitle" placeholder="Enter subtitle">
            </div>
            
            <div class="form-group">
                <label for="authorName">Author Name</label>
                <input type="text" id="authorName" placeholder="Enter author name" value="John Smith">
            </div>

            <h2 class="section-title">🎨 Design</h2>
            
            <div class="form-group">
                <label>Background Style</label>
                <div class="preset-grid">
                    <div class="preset-btn active" data-bg="gradient">Gradient</div>
                    <div class="preset-btn" data-bg="solid">Solid Color</div>
                    <div class="preset-btn" data-bg="image">Image</div>
                    <div class="preset-btn" data-bg="pattern">Pattern</div>
                </div>
            </div>

            <div class="form-group" id="gradientPicker">
                <label>Gradient Presets</label>
                <div class="gradient-picker">
                    <div class="gradient-option active" style="background: linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)" data-gradient="linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)" data-gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%)" data-gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)" data-gradient="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)" data-gradient="linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%)" data-gradient="linear-gradient(135deg, #fa709a 0%, #fee140 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)" data-gradient="linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"></div>
                    <div class="gradient-option" style="background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 100%)" data-gradient="linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 100%)"></div>
                </div>
            </div>

            <div class="form-group" id="solidColorPicker" style="display: none;">
                <label for="bgColor">Background Color</label>
                <input type="color" id="bgColor" class="color-input" value="#667eea">
            </div>

            <div class="form-group" id="imageUpload" style="display: none;">
                <label for="bgImage">Background Image</label>
                <input type="file" id="bgImage" accept="image/*">
            </div>

            <h2 class="section-title">🔤 Typography</h2>
            
            <div class="form-group">
                <label for="titleFont">Title Font</label>
                <select id="titleFont">
                    <option value="'Playfair Display', serif">Playfair Display</option>
                    <option value="'Montserrat', sans-serif">Montserrat</option>
                    <option value="'Crimson Text', serif">Crimson Text</option>
                    <option value="'Oswald', sans-serif">Oswald</option>
                    <option value="'Lora', serif">Lora</option>
                    <option value="'Roboto Condensed', sans-serif">Roboto Condensed</option>
                </select>
                <div class="font-preview" id="titlePreview">Sample Title Text</div>
            </div>
            
            <div class="form-group">
                <label for="titleSize">Title Size</label>
                <input type="range" id="titleSize" min="24" max="72" value="48">
                <span id="titleSizeValue">48px</span>
            </div>
            
            <div class="form-group">
                <label for="titleColor">Title Color</label>
                <input type="color" id="titleColor" class="color-input" value="#ffffff">
            </div>

            <div class="form-group">
                <label for="authorFont">Author Font</label>
                <select id="authorFont">
                    <option value="'Montserrat', sans-serif">Montserrat</option>
                    <option value="'Playfair Display', serif">Playfair Display</option>
                    <option value="'Lato', sans-serif">Lato</option>
                    <option value="'Open Sans', sans-serif">Open Sans</option>
                </select>
            </div>

            <h2 class="section-title">✨ Effects</h2>
            
            <div class="effects-grid">
                <div class="effect-btn active" data-effect="shadow">Text Shadow</div>
                <div class="effect-btn" data-effect="glow">Text Glow</div>
                <div class="effect-btn" data-effect="outline">Text Outline</div>
                <div class="effect-btn" data-effect="none">No Effects</div>
            </div>

            <h2 class="section-title">📐 Dimensions</h2>
            
            <div class="form-group">
                <label>Preset Sizes</label>
                <div class="preset-grid">
                    <div class="preset-btn active" data-size="400,600">Standard</div>
                    <div class="preset-btn" data-size="375,563">Paperback</div>
                    <div class="preset-btn" data-size="450,675">Hardcover</div>
                    <div class="preset-btn" data-size="custom">Custom</div>
                </div>
            </div>

            <div class="form-group" id="customDimensions" style="display: none;">
                <label>Custom Size</label>
                <div class="dimension-inputs">
                    <input type="number" id="customWidth" placeholder="Width" value="400">
                    <input type="number" id="customHeight" placeholder="Height" value="600">
                </div>
            </div>
        </div>

        <div class="main-area">
            <div class="toolbar">
                <div class="toolbar-left">
                    <h1 style="font-size: 24px; color: #333; font-weight: 700;">📖 Book Cover Designer</h1>
                </div>
                <div class="toolbar-right">
                    <div class="zoom-controls">
                        <button class="zoom-btn" id="zoomOut">−</button>
                        <span id="zoomLevel">100%</span>
                        <button class="zoom-btn" id="zoomIn">+</button>
                    </div>
                    <button class="btn btn-secondary" id="resetBtn">🔄 Reset</button>
                    <button class="btn btn-primary" id="downloadBtn">💾 Download Cover</button>
                </div>
            </div>

            <div class="canvas-container">
                <div class="book-cover" id="bookCover">
                    <div class="cover-content">
                        <div class="title" id="displayTitle">The Great Adventure</div>
                        <div class="subtitle" id="displaySubtitle"></div>
                        <div class="author" id="displayAuthor">John Smith</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@400;600;700&family=Crimson+Text:wght@400;600&family=Oswald:wght@400;600&family=Lora:wght@400;700&family=Roboto+Condensed:wght@400;700&family=Lato:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <script>
        class BookCoverDesigner {
            constructor() {
                this.elements = {
                    bookCover: document.getElementById('bookCover'),
                    displayTitle: document.getElementById('displayTitle'),
                    displaySubtitle: document.getElementById('displaySubtitle'),
                    displayAuthor: document.getElementById('displayAuthor'),
                    bookTitle: document.getElementById('bookTitle'),
                    bookSubtitle: document.getElementById('bookSubtitle'),
                    authorName: document.getElementById('authorName'),
                    titleFont: document.getElementById('titleFont'),
                    titleSize: document.getElementById('titleSize'),
                    titleSizeValue: document.getElementById('titleSizeValue'),
                    titleColor: document.getElementById('titleColor'),
                    authorFont: document.getElementById('authorFont'),
                    bgColor: document.getElementById('bgColor'),
                    bgImage: document.getElementById('bgImage'),
                    titlePreview: document.getElementById('titlePreview'),
                    zoomIn: document.getElementById('zoomIn'),
                    zoomOut: document.getElementById('zoomOut'),
                    zoomLevel: document.getElementById('zoomLevel'),
                    resetBtn: document.getElementById('resetBtn'),
                    downloadBtn: document.getElementById('downloadBtn')
                };

                this.state = {
                    zoom: 1,
                    backgroundType: 'gradient',
                    currentGradient: 'linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)',
                    textEffect: 'shadow',
                    coverWidth: 400,
                    coverHeight: 600
                };

                this.init();
            }

            init() {
                this.bindEvents();
                this.updatePreview();
            }

            bindEvents() {
                // Text inputs
                this.elements.bookTitle.addEventListener('input', () => this.updateText());
                this.elements.bookSubtitle.addEventListener('input', () => this.updateText());
                this.elements.authorName.addEventListener('input', () => this.updateText());

                // Font controls
                this.elements.titleFont.addEventListener('change', () => this.updateFonts());
                this.elements.authorFont.addEventListener('change', () => this.updateFonts());
                this.elements.titleSize.addEventListener('input', () => this.updateTitleSize());
                this.elements.titleColor.addEventListener('input', () => this.updateColors());

                // Background controls
                this.elements.bgColor.addEventListener('input', () => this.updateBackground());
                this.elements.bgImage.addEventListener('change', () => this.handleImageUpload());

                // Preset buttons
                document.querySelectorAll('.preset-btn[data-bg]').forEach(btn => {
                    btn.addEventListener('click', () => this.setBackgroundType(btn.dataset.bg));
                });

                document.querySelectorAll('.gradient-option').forEach(btn => {
                    btn.addEventListener('click', () => this.setGradient(btn.dataset.gradient));
                });

                document.querySelectorAll('.effect-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.setTextEffect(btn.dataset.effect));
                });

                document.querySelectorAll('.preset-btn[data-size]').forEach(btn => {
                    btn.addEventListener('click', () => this.setSize(btn.dataset.size));
                });

                // Toolbar controls
                this.elements.zoomIn.addEventListener('click', () => this.adjustZoom(0.1));
                this.elements.zoomOut.addEventListener('click', () => this.adjustZoom(-0.1));
                this.elements.resetBtn.addEventListener('click', () => this.reset());
                this.elements.downloadBtn.addEventListener('click', () => this.downloadCover());

                // Custom dimensions
                document.getElementById('customWidth').addEventListener('input', () => this.updateCustomSize());
                document.getElementById('customHeight').addEventListener('input', () => this.updateCustomSize());
            }

            updateText() {
                const title = this.elements.bookTitle.value || 'Your Book Title';
                const subtitle = this.elements.bookSubtitle.value;
                const author = this.elements.authorName.value || 'Author Name';

                this.elements.displayTitle.textContent = title;
                this.elements.displaySubtitle.textContent = subtitle;
                this.elements.displayAuthor.textContent = author;

                // Show/hide subtitle
                this.elements.displaySubtitle.style.display = subtitle ? 'block' : 'none';
            }

            updateFonts() {
                const titleFont = this.elements.titleFont.value;
                const authorFont = this.elements.authorFont.value;

                this.elements.displayTitle.style.fontFamily = titleFont;
                this.elements.displayAuthor.style.fontFamily = authorFont;
                this.elements.titlePreview.style.fontFamily = titleFont;
                this.elements.titlePreview.textContent = titleFont.split(',')[0].replace(/'/g, '');
            }

            updateTitleSize() {
                const size = this.elements.titleSize.value;
                this.elements.displayTitle.style.fontSize = size + 'px';
                this.elements.titleSizeValue.textContent = size + 'px';
            }

            updateColors() {
                const titleColor = this.elements.titleColor.value;
                this.elements.displayTitle.style.color = titleColor;
                this.elements.displayAuthor.style.color = titleColor;
                this.elements.displaySubtitle.style.color = titleColor + 'e6'; // 90% opacity
            }

            setBackgroundType(type) {
                this.state.backgroundType = type;
                
                // Update active button
                document.querySelectorAll('.preset-btn[data-bg]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.preset-btn[data-bg="${type}"]`).classList.add('active');

                // Show/hide relevant controls
                document.getElementById('gradientPicker').style.display = type === 'gradient' ? 'block' : 'none';
                document.getElementById('solidColorPicker').style.display = type === 'solid' ? 'block' : 'none';
                document.getElementById('imageUpload').style.display = type === 'image' ? 'block' : 'none';

                this.updateBackground();
            }

            setGradient(gradient) {
                this.state.currentGradient = gradient;
                
                // Update active gradient
                document.querySelectorAll('.gradient-option').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.gradient-option[data-gradient="${gradient}"]`).classList.add('active');

                this.updateBackground();
            }

            updateBackground() {
                switch(this.state.backgroundType) {
                    case 'gradient':
                        this.elements.bookCover.style.background = this.state.currentGradient;
                        break;
                    case 'solid':
                        this.elements.bookCover.style.background = this.elements.bgColor.value;
                        break;
                    case 'pattern':
                        this.elements.bookCover.style.background = `
                            radial-gradient(circle at 25% 25%, #667eea 0%, transparent 50%),
                            radial-gradient(circle at 75% 75%, #764ba2 0%, transparent 50%),
                            linear-gradient(45deg, #f093fb 0%, #f5576c 100%)
                        `;
                        break;
                }
            }

            handleImageUpload() {
                const file = this.elements.bgImage.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.elements.bookCover.style.backgroundImage = `url(${e.target.result})`;
                        this.elements.bookCover.style.backgroundSize = 'cover';
                        this.elements.bookCover.style.backgroundPosition = 'center';
                    };
                    reader.readAsDataURL(file);
                }
            }

            setTextEffect(effect) {
                this.state.textEffect = effect;
                
                // Update active button
                document.querySelectorAll('.effect-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.effect-btn[data-effect="${effect}"]`).classList.add('active');

                const elements = [this.elements.displayTitle, this.elements.displayAuthor, this.elements.displaySubtitle];
                
                elements.forEach(el => {
                    switch(effect) {
                        case 'shadow':
                            el.style.textShadow = '2px 2px 4px rgba(0, 0, 0, 0.5)';
                            el.style.webkitTextStroke = '';
                            break;
                        case 'glow':
                            el.style.textShadow = '0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.6)';
                            el.style.webkitTextStroke = '';
                            break;
                        case 'outline':
                            el.style.textShadow = '';
                            el.style.webkitTextStroke = '2px rgba(0, 0, 0, 0.8)';
                            break;
                        case 'none':
                            el.style.textShadow = '';
                            el.style.webkitTextStroke = '';
                            break;
                    }
                });
            }

            setSize(size) {
                // Update active button
                document.querySelectorAll('.preset-btn[data-size]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.preset-btn[data-size="${size}"]`).classList.add('active');

                const customDiv = document.getElementById('customDimensions');
                
                if (size === 'custom') {
                    customDiv.style.display = 'block';
                    this.updateCustomSize();
                } else {
                    customDiv.style.display = 'none';
                    const [width, height] = size.split(',').map(Number);
                    this.state.coverWidth = width;
                    this.state.coverHeight = height;
                    this.elements.bookCover.style.width = width + 'px';
                    this.elements.bookCover.style.height = height + 'px';
                }
            }

            updateCustomSize() {
                const width = parseInt(document.getElementById('customWidth').value) || 400;
                const height = parseInt(document.getElementById('customHeight').value) || 600;
                
                this.state.coverWidth = width;
                this.state.coverHeight = height;
                this.elements.bookCover.style.width = width + 'px';
                this.elements.bookCover.style.height = height + 'px';
            }

            adjustZoom(delta) {
                this.state.zoom = Math.max(0.5, Math.min(2, this.state.zoom + delta));
                const zoomPercent = Math.round(this.state.zoom * 100);
                this.elements.zoomLevel.textContent = zoomPercent + '%';
                this.elements.bookCover.style.transform = 
                    `perspective(1000px) rotateY(-5deg) scale(${this.state.zoom})`;
            }

            reset() {
                // Reset form values
                this.elements.bookTitle.value = 'The Great Adventure';
                this.elements.bookSubtitle.value = '';
                this.elements.authorName.value = 'John Smith';
                this.elements.titleFont.value = "'Playfair Display', serif";
                this.elements.authorFont.value = "'Montserrat', sans-serif";
                this.elements.titleSize.value = 48;
                this.elements.titleColor.value = '#ffffff';
                this.elements.bgColor.value = '#667eea';

                // Reset state
                this.state = {
                    zoom: 1,
                    backgroundType: 'gradient',
                    currentGradient: 'linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)',
                    textEffect: 'shadow',
                    coverWidth: 400,
                    coverHeight: 600
                };

                // Reset UI
                this.setBackgroundType('gradient');
                this.setGradient('linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)');
                this.setTextEffect('shadow');
                this.setSize('400,600');
                this.adjustZoom(1 - this.state.zoom);

                // Update display
                this.updatePreview();
            }

            updatePreview() {
                this.updateText();
                this.updateFonts();
                this.updateTitleSize();
                this.updateColors();
                this.updateBackground();
            }

            async downloadCover() {
                this.elements.downloadBtn.classList.add('downloading');
                this.elements.downloadBtn.textContent = '⏳ Generating...';

                try {
                    // Create a temporary canvas
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Set canvas dimensions to match book cover
                    canvas.width = this.state.coverWidth * 2; // Higher resolution
                    canvas.height = this.state.coverHeight * 2;
                    
                    // Scale context for higher resolution
                    ctx.scale(2, 2);

                    // Draw background
                    await this.drawBackground(ctx);

                    // Draw text
                    this.drawText(ctx);

                    // Create download link
                    const link = document.createElement('a');
                    link.download = `${this.elements.bookTitle.value || 'book-cover'}.png`;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    link.click();

                    // Show success animation
                    this.elements.downloadBtn.textContent = '✅ Downloaded!';
                    setTimeout(() => {
                        this.elements.downloadBtn.textContent = '💾 Download Cover';
                        this.elements.downloadBtn.classList.remove('downloading');
                    }, 2000);

                } catch (error) {
                    console.error('Download failed:', error);
                    this.elements.downloadBtn.textContent = '❌ Error';
                    setTimeout(() => {
                        this.elements.downloadBtn.textContent = '💾 Download Cover';
                        this.elements.downloadBtn.classList.remove('downloading');
                    }, 2000);
                }
            }

            async drawBackground(ctx) {
                const width = this.state.coverWidth;
                const height = this.state.coverHeight;

                switch(this.state.backgroundType) {
                    case 'gradient':
                        this.drawGradientBackground(ctx, width, height);
                        break;
                    case 'solid':
                        ctx.fillStyle = this.elements.bgColor.value;
                        ctx.fillRect(0, 0, width, height);
                        break;
                    case 'pattern':
                        this.drawPatternBackground(ctx, width, height);
                        break;
                    case 'image':
                        await this.drawImageBackground(ctx, width, height);
                        break;
                }
            }

            drawGradientBackground(ctx, width, height) {
                // Parse gradient from current gradient string
                const gradientData = this.parseGradient(this.state.currentGradient);
                
                let gradient;
                if (gradientData.type === 'linear') {
                    gradient = ctx.createLinearGradient(0, 0, width, height);
                } else {
                    gradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, Math.max(width, height)/2);
                }

                gradientData.stops.forEach(stop => {
                    gradient.addColorStop(stop.position, stop.color);
                });

                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);
            }

            parseGradient(gradientString) {
                // Simple gradient parser for common formats
                const gradientData = { type: 'linear', stops: [] };
                
                // Default gradients based on current selection
                const gradients = {
                    'linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)': [
                        { position: 0, color: '#ff9a8b' },
                        { position: 1, color: '#a8edea' }
                    ],
                    'linear-gradient(135deg, #667eea 0%, #764ba2 100%)': [
                        { position: 0, color: '#667eea' },
                        { position: 1, color: '#764ba2' }
                    ],
                    'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)': [
                        { position: 0, color: '#f093fb' },
                        { position: 1, color: '#f5576c' }
                    ],
                    'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)': [
                        { position: 0, color: '#4facfe' },
                        { position: 1, color: '#00f2fe' }
                    ],
                    'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)': [
                        { position: 0, color: '#43e97b' },
                        { position: 1, color: '#38f9d7' }
                    ],
                    'linear-gradient(135deg, #fa709a 0%, #fee140 100%)': [
                        { position: 0, color: '#fa709a' },
                        { position: 1, color: '#fee140' }
                    ],
                    'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)': [
                        { position: 0, color: '#a8edea' },
                        { position: 1, color: '#fed6e3' }
                    ],
                    'linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 100%)': [
                        { position: 0, color: '#ff6b6b' },
                        { position: 1, color: '#4ecdc4' }
                    ]
                };

                gradientData.stops = gradients[gradientString] || gradients['linear-gradient(135deg, #ff9a8b 0%, #a8edea 100%)'];
                return gradientData;
            }

            drawPatternBackground(ctx, width, height) {
                // Create a complex pattern background
                const gradient1 = ctx.createRadialGradient(width * 0.25, height * 0.25, 0, width * 0.25, height * 0.25, width * 0.5);
                gradient1.addColorStop(0, '#667eea');
                gradient1.addColorStop(1, 'transparent');

                const gradient2 = ctx.createRadialGradient(width * 0.75, height * 0.75, 0, width * 0.75, height * 0.75, width * 0.5);
                gradient2.addColorStop(0, '#764ba2');
                gradient2.addColorStop(1, 'transparent');

                const baseGradient = ctx.createLinearGradient(0, 0, width, height);
                baseGradient.addColorStop(0, '#f093fb');
                baseGradient.addColorStop(1, '#f5576c');

                ctx.fillStyle = baseGradient;
                ctx.fillRect(0, 0, width, height);

                ctx.globalCompositeOperation = 'multiply';
                ctx.fillStyle = gradient1;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = gradient2;
                ctx.fillRect(0, 0, width, height);

                ctx.globalCompositeOperation = 'source-over';
            }

            async drawImageBackground(ctx, width, height) {
                const file = this.elements.bgImage.files[0];
                if (file) {
                    return new Promise((resolve) => {
                        const img = new Image();
                        img.onload = () => {
                            ctx.drawImage(img, 0, 0, width, height);
                            resolve();
                        };
                        img.src = URL.createObjectURL(file);
                    });
                }
            }

            drawText(ctx) {
                const width = this.state.coverWidth;
                const height = this.state.coverHeight;
                
                // Set text properties
                ctx.textAlign = 'center';
                ctx.fillStyle = this.elements.titleColor.value;

                // Apply text effects
                this.applyTextEffects(ctx);

                // Draw title
                const titleSize = parseInt(this.elements.titleSize.value);
                ctx.font = `bold ${titleSize}px ${this.elements.titleFont.value}`;
                
                const title = this.elements.bookTitle.value || 'Your Book Title';
                this.wrapText(ctx, title, width / 2, height * 0.25, width * 0.8, titleSize * 1.2);

                // Draw subtitle if exists
                const subtitle = this.elements.bookSubtitle.value;
                if (subtitle) {
                    ctx.font = `${titleSize * 0.5}px ${this.elements.titleFont.value}`;
                    ctx.globalAlpha = 0.9;
                    ctx.fillText(subtitle, width / 2, height * 0.4);
                    ctx.globalAlpha = 1;
                }

                // Draw author
                ctx.font = `${titleSize * 0.6}px ${this.elements.authorFont.value}`;
                const author = this.elements.authorName.value || 'Author Name';
                ctx.fillText(author, width / 2, height * 0.85);
            }

            applyTextEffects(ctx) {
                switch(this.state.textEffect) {
                    case 'shadow':
                        ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                        ctx.shadowBlur = 4;
                        ctx.shadowOffsetX = 2;
                        ctx.shadowOffsetY = 2;
                        break;
                    case 'glow':
                        ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
                        ctx.shadowBlur = 10;
                        ctx.shadowOffsetX = 0;
                        ctx.shadowOffsetY = 0;
                        break;
                    case 'outline':
                        ctx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
                        ctx.lineWidth = 2;
                        break;
                    case 'none':
                        ctx.shadowColor = 'transparent';
                        ctx.shadowBlur = 0;
                        ctx.shadowOffsetX = 0;
                        ctx.shadowOffsetY = 0;
                        break;
                }
            }

            wrapText(ctx, text, x, y, maxWidth, lineHeight) {
                const words = text.split(' ');
                let line = '';
                let currentY = y;

                for (let n = 0; n < words.length; n++) {
                    const testLine = line + words[n] + ' ';
                    const metrics = ctx.measureText(testLine);
                    const testWidth = metrics.width;

                    if (testWidth > maxWidth && n > 0) {
                        if (this.state.textEffect === 'outline') {
                            ctx.strokeText(line, x, currentY);
                        }
                        ctx.fillText(line, x, currentY);
                        line = words[n] + ' ';
                        currentY += lineHeight;
                    } else {
                        line = testLine;
                    }
                }

                if (this.state.textEffect === 'outline') {
                    ctx.strokeText(line, x, currentY);
                }
                ctx.fillText(line, x, currentY);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new BookCoverDesigner();
        });
    </script>
</body>
</html>